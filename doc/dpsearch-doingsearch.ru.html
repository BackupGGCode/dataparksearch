<HTML
><HEAD
><TITLE
>Поиск документов</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.73
"><LINK
REL="HOME"
TITLE="DataparkSearch Engine 4.50"
HREF="index.ru.html"><LINK
REL="PREVIOUS"
TITLE="Поддержка мультиязычных веб серверов"
HREF="dpsearch-vary.ru.html"><LINK
REL="NEXT"
TITLE="Модуль mod_dpsearch для Apache httpd




"
HREF="dpsearch-mod_dpsearch.ru.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="datapark.css"><META
NAME="Description"
CONTENT="DataparkSearch - Полнофункциональная поисковая машина для Интернета и Интранета с открытым исходным кодом. Распространяется по лицензии GNU."><META
NAME="Keywords"
CONTENT="shareware, freeware, интернет, unix, поисковик, поисковая машина, поиск, поиск информации, интранет, open source, opensource, search, searching, software, udmsearch, engine, indexing, system, web, ftp, http, cgi, php, SQL, MySQL, database, php3, FreeBSD, Linux, Unix, DataparkSearch, MacOS X, Mac OS X, Windows, 2000, NT, 95, 98, GNU, GPL, url, grabbing"><SCRIPT
SRC="http://www.google-analytics.com/urchin.js"
TYPE="text/javascript"></SCRIPT><SCRIPT
SRC="http://www.dataparksearch.org/ga.js"
TYPE="text/javascript"></SCRIPT></HEAD
><BODY
CLASS="chapter"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000C4"
VLINK="#1200B2"
ALINK="#C40000"
><!--#include virtual="body-before.html"--><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>DataparkSearch Engine 4.50: Справочное руководство</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="dpsearch-vary.ru.html"
ACCESSKEY="P"
>&#1055;&#1088;&#1077;&#1076;.</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="dpsearch-mod_dpsearch.ru.html"
ACCESSKEY="N"
>&#1057;&#1083;&#1077;&#1076;.</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="chapter"
><H1
><A
NAME="doingsearch"
>&#1043;&#1083;&#1072;&#1074;&#1072; 8. Поиск документов</A
></H1
><DIV
CLASS="TOC"
><DL
><DT
><B
>&#1057;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1085;&#1080;&#1077;</B
></DT
><DT
>8.1. <A
HREF="dpsearch-doingsearch.ru.html#search"
>Использование поисковых фронт-эндов</A
></DT
><DT
>8.2. <A
HREF="dpsearch-mod_dpsearch.ru.html"
>Модуль <TT
CLASS="literal"
>mod_dpsearch</TT
> для Apache httpd
<A
NAME="AEN4564"
></A
>
<A
NAME="AEN4566"
></A
>
<A
NAME="AEN4569"
></A
>
<A
NAME="AEN4572"
></A
></A
></DT
><DT
>8.3. <A
HREF="dpsearch-templates.ru.html"
>Как создавать шаблоны результатов поиска
<A
NAME="AEN4622"
></A
></A
></DT
><DT
>8.4. <A
HREF="dpsearch-html.ru.html"
>Дизайн search.html</A
></DT
><DT
>8.5. <A
HREF="dpsearch-rel.ru.html"
>Релевантность
<A
NAME="AEN5183"
></A
></A
></DT
><DT
>8.6. <A
HREF="dpsearch-track.ru.html"
>Регистрация поисковых запросов
<A
NAME="AEN5417"
></A
></A
></DT
><DT
>8.7. <A
HREF="dpsearch-srcache.ru.html"
>Кэш результатов поиска
<A
NAME="AEN5448"
></A
></A
></DT
><DT
>8.8. <A
HREF="dpsearch-fuzzy.ru.html"
>Нечёткий поиск</A
></DT
></DL
></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="search"
>8.1. Использование поисковых фронт-эндов</A
></H1
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search-perform"
>8.1.1. Осуществление поиска</A
></H2
><P
>Откройте предпочитаймый вами фронт-энд в окне броузера:
		<PRE
CLASS="programlisting"
>&#13;http://your.web.server/path/to/search.cgi


</PRE
>
</P
><P
>Чтобы найти что-то, просто наберите слова, которые хотите найти и нажмите кнопку ОТОСЛАТЬ.
Например: <TT
CLASS="userinput"
><B
>mysql odbc</B
></TT
>. 
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> найдет все документы, содержащие слово <TT
CLASS="option"
>mysql</TT
> и/или слово <TT
CLASS="option"
>odbc</TT
>.
Лучшие документы, имеющий более высокую релевантность и популярность будут показаны первыми.</P
><P
>Чтобы найти фразу, просто заключите её в кавычки. Например:
<TT
CLASS="userinput"
><B
>"uncontrollable sphere"</B
></TT
>.
</P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search_params"
>8.1.2. Параметры поиска
<A
NAME="AEN4239"
></A
></A
></H2
><P
>Фронт-энды <SPAN
CLASS="application"
>DataparkSearch</SPAN
> поддерживают следующие параметры,
указываемыме в CGI-запросе. Вы можете использовать их в HTML форме на странице поиска.</P
><DIV
CLASS="table"
><A
NAME="search-params"
></A
><P
><B
>&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 8-1. Параметры поиска</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><TBODY
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>q</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>текстовый параметр, содержащий запрос на поиск</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>vq</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>текстовый параметр, содержащий поисковый запрос на языке <SPAN
CLASS="application"
>Verity Query Language</SPAN
> (префиксный вариант), см <A
HREF="dpsearch-doingsearch.ru.html#vql"
>&#1056;&#1072;&#1079;&#1076;. 8.1.7</A
>. Чтобы использовать этот параметр, необходимо омтавить пустым параметр q.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>s</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>строка символов, задающая порядок сортировки результатов поиска.
Порадок сортировки задаётся слева направо. Большая буква соответсвует сортировке по убыванию, маленькая - по возрастанию.
Возможные символы: <TT
CLASS="literal"
>R</TT
> или <TT
CLASS="literal"
>r</TT
> - сортировка по релевантности, 
<TT
CLASS="literal"
>P</TT
> или <TT
CLASS="literal"
>p</TT
> - сортировка по PopularityRank,
<TT
CLASS="literal"
>I</TT
> или <TT
CLASS="literal"
>i</TT
> - сортировка по важности (произведению релевантности и PopularityRank),
<TT
CLASS="literal"
>A</TT
> или <TT
CLASS="literal"
>a</TT
> - сортировка по сумме релевантности и PopularityRank,
<TT
CLASS="literal"
>D</TT
> или <TT
CLASS="literal"
>d</TT
> - сортировка по дате последнего изменения документа.
Значение по умолчанию: <TT
CLASS="literal"
>RP</TT
>.
                                                </TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>ps</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#13;число результатов поиска, отображаемых на одной странице, 20 по умолчанию. Максимальное значение равно 100.
Это ограничение введено во избежание излишней перегрузки сервера и может быть изменено заменой значения  MAX_PS
в файле <TT
CLASS="filename"
>search.c</TT
>.

</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>np</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>номер страницы начиная с 0, 0 по умолчанию (первая страница)</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>p</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>номер страницы начиная с 1, для использования с OpenSearch</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>m</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Режим поиска. На данный момент поддерживаются значения <TT
CLASS="literal"
>all</TT
>,
<TT
CLASS="literal"
>any</TT
>, <TT
CLASS="literal"
>near</TT
> и <TT
CLASS="literal"
>bool</TT
>.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>wm</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Совпадение слова. Вы можете использовать этот параметр для указания
способа совпадения слов. Зачения <TT
CLASS="literal"
>wrd</TT
>, <TT
CLASS="literal"
>beg</TT
>, <TT
CLASS="literal"
>end</TT
> и <TT
CLASS="literal"
>sub</TT
>
соответственно обозначают целое слово, начало слова, окончание слова и подстрока слова.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>t</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Лимит по тэгу. Задаёт поиск только среди документов, помеченых указаным тэгом.
Этот параметр имеет то же значение, что и ключ <TT
CLASS="option"
>-t</TT
> у <B
CLASS="command"
>indexer</B
>.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>c</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Лимит по категории. См. <A
HREF="dpsearch-categories.ru.html"
>&#1056;&#1072;&#1079;&#1076;. 6.2</A
> для описания.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>ul</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Лимит по URL, подстрока URL для ограничения поиска по части базы.
Поддерживаются SQL шаблоны % и _. Этот параметр имеет тот же эффект, что и ключ <TT
CLASS="option"
>-u</TT
> у <B
CLASS="command"
>indexer</B
>.
Если указан неабсолютный URL, <TT
CLASS="filename"
>search.cgi</TT
> дообавит знаки % до и после значения этого параметра,
если используется SQL база данных для хранения информации. Например, 
&#60;OPTION VALUE="/manual/"&#62; а не VALUE="%/manual/%". Если указан полный URL (с указанием схемы)б <TT
CLASS="filename"
>search.cgi</TT
>
добавляет знак % только после значения этого параметра. Например, для  &#60;OPTION VALUE="http://localhost/"&#62;
 <TT
CLASS="filename"
>search.cgi</TT
> передаст <TT
CLASS="literal"
>http://localhost/%</TT
> в оператор SQL LIKE.
<DIV
CLASS="note"
><BLOCKQUOTE
CLASS="note"
>Не поддерживается для способа хранения cache.</BLOCKQUOTE
></DIV
>
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>wf</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Значения весов. Позволяет изменить значения весов различных секций
документов во аремя поиска. Значение должно представлять из себя строку шестнадцатеричных чисел.
См. обяснение ниже в <A
HREF="dpsearch-doingsearch.ru.html#search-changeweight"
>&#1056;&#1072;&#1079;&#1076;. 8.1.3</A
>.
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>g или lang</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Лимит по языку. Стандартный двубуквенный код языка по ISO,
для ограничения поиска по полю url.lang.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>tmplt</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Имя файла шаблона (без пути).
Для указания имени файла шаблона, отличного от стандартного <TT
CLASS="filename"
>search.htm</TT
>.
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>type</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Лимит по Content-Type.
Для способа хранения cache должно быть точное соответсвие. Для SQL-режимов возможно использование шаблонов SQL.
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>sp</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Ограничение использования словоформ.
=1, если необходим поиск по всем словоформам (включая корректировку правописания, если включена поддержка aspell) введённых слов.
=0, если необходим поиск только введенных форм слов. Значение по умолчанию равно 1. Вы можете указать значение 0 для ускорения поиска.
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>sy</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Ограничение использования синонимов.
=1, если необходимо использовать синонимы введённых слов.
=0, не использовать синонимы. Значение по умолчанию равно 1. Вы можете указать значение 0 для ускорения поиска.
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>empty</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Использовать ли лимиты для вывода результатов, если не задано ни одного слова в запросе.
=yes, использовать лиминты для вывода результатов, если не задано ни одного слова в запросе (по умолчанию).
=no, не использовать.
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>dt</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
> Ограничение по времени. Поддерживается три типа.
				<P
>Если <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>back</TT
>, это означает, что вы хотите ограничить
результаты поиска по давности. Давность ограничивается параметром <TT
CLASS="literal"
>dp</TT
>.</P
>
				<P
>Если <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>er</TT
>, это означает, что поиск поиск будет ограничен
страницами старше или новее указаной даты. Старше/новее задаётся параметром <TT
CLASS="option"
>dx</TT
>.
Дата задаётся параметрами <TT
CLASS="option"
>dm, dy, dd</TT
>.</P
>
				<P
>Если <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>range</TT
>, обозначает, что поиск будет ограничен
двумя датами, начала и конца. Даты задаются двумя параметрами, соответственно <TT
CLASS="option"
>db</TT
> и <TT
CLASS="option"
>de</TT
>.</P
>
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>dp</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Ограничение по давности, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>back</TT
>.
Задаётся в формате <TT
CLASS="literal"
>xxxA[yyyB[zzzC]]</TT
>. Пробелы допускаются между xxx и A и yyy и т.д.).
 xxx, yyy, zzz - суть числа (могут быть негативными!), A, B, C могут быть одним из следующего (буквы такие же как в функциях
strptime/strftime): s - секунда, M - минута, h - час, d - день, m - месяц, y - год. Примеры:
				<PRE
CLASS="programlisting"
>&#13;  4h30M 	  - 2 часа и 30 минут
  1Y6m-15d        - 1 год и шесть месяцев минус 15 дней
  1h-60M+1s       - 1 час минус 60 минут плюс 1 секунда
</PRE
>
</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>dx</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Флаг старше/новее, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>er</TT
>. =1 - новее. =-1 - старше.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>dm</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Месяц даты, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>er</TT
>. 0 - январь, 1 - февраль, ... 
11 - декабрь.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>dy</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Год даты, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>er</TT
>. Четыре цифры. Например, 1999 или 2001.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>dd</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>День даты, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>er</TT
>. 1...31.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>db</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Начальная дата интервала, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>range</TT
>. Дата указывается как строка в формате
dd/mm/yyyy, где dd - день, mm - месяц, а yyyy - четырёхцифровой год.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>de</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>Конечная дата интервала, если значение <TT
CLASS="literal"
>dt</TT
> равно <TT
CLASS="literal"
>range</TT
>. Дата указывается как строка в формате
dd/mm/yyyy, где dd - день, mm - месяц, а yyyy - четырёхцифровой год.</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search-changeweight"
>8.1.3. Изменение весов различных частей документов во время поиска</A
></H2
><P
> Параметр <TT
CLASS="option"
>wf</TT
>, передаваемый в <TT
CLASS="filename"
>search.cgi</TT
> задаёт веса
для различных секций документов. См. раздел "Section" в файле <TT
CLASS="filename"
>indexer.conf-dist</TT
>.</P
><P
>Для использования этой возможности необходимо иметь уникальные ID для различных
секций документов, указываемых в командах <B
CLASS="command"
>Section</B
> файла конфигурации 
<TT
CLASS="filename"
>indexer.conf</TT
> command. На данный момент поддерживается до 256 различных секций.</P
><P
>Предположим, что в <TT
CLASS="filename"
>indexer.conf</TT
> определены следующие секции:
		<PRE
CLASS="programlisting"
>&#13;  Section body        1  256
  Section title       2  128
  Section keywords    3  128
  Section description 4  128
</PRE
>
		</P
><P
>Значение <TT
CLASS="option"
>wf</TT
> - строка шестнадцатиричных цифр ABCD. Каждая цифра - вес
соответствующей секции документа. Самая правая цифра соответсвует секции 1. Для указанной выше конфигурации секций:
		<P
CLASS="literallayout"
><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;-&nbsp;вес&nbsp;для&nbsp;секции&nbsp;1&nbsp;(body)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;-&nbsp;вес&nbsp;для&nbsp;секции&nbsp;2&nbsp;(title)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;-&nbsp;вес&nbsp;для&nbsp;секции&nbsp;3&nbsp;(keywords)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;-&nbsp;вес&nbsp;для&nbsp;секции&nbsp;4&nbsp;(description)<br>
</P
>
</P
><P
>Примеры:
		<P
CLASS="literallayout"
><br>
&nbsp;&nbsp;&nbsp;wf=0001&nbsp;поиск&nbsp;только&nbsp;по&nbsp;секции&nbsp;body.<br>
<br>
&nbsp;&nbsp;&nbsp;wf=1110&nbsp;поиск&nbsp;по&nbsp;секциям&nbsp;title,keywords,desctription,&nbsp;но&nbsp;не&nbsp;по&nbsp;секции&nbsp;body.<br>
<br>
&nbsp;&nbsp;&nbsp;wf=F421&nbsp;поиск&nbsp;по:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description&nbsp;с&nbsp;весом&nbsp;15&nbsp;&nbsp;(F&nbsp;hex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keywords&nbsp;с&nbsp;весом&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title&nbsp;с&nbsp;весом&nbsp;&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Body&nbsp;с&nbsp;весом&nbsp;1<br>
</P
>
</P
><P
>По умолчанию, все секции имеют вес 1.</P
><P
>По умолчанию, <SPAN
CLASS="application"
>DataparkSearch</SPAN
> собирается с быстрым вариантом расчёта релевантности.
В этом случае только нулевое или ненулевое значение веса имеет смысл (это позволяет только включать/исключать
заданые секции из результатов поиска). Чтобы включить полную поддержку динамических весов секций, необходимо
задать опцию <TT
CLASS="option"
>--enable-fullrel</TT
> для <B
CLASS="command"
>configure</B
> во время сборки <SPAN
CLASS="application"
>DataparkSearch</SPAN
>.
</P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search-scriptname"
>8.1.4. Использование фронт-энда на страницах с SSI</A
></H2
><P
>При сипользовании динамических shtml страниц, содержащих SSI вызов <TT
CLASS="filename"
>search.cgi</TT
>,
т.е. <TT
CLASS="filename"
>search.cgi</TT
> не вызывается напрямую как CGI программа,
необходимо отвергнуть переменную окружения SCRIPT_NAME, т.к. все ссылки на страницах поиска должны вести на
динамическую страницу, а не на  <TT
CLASS="filename"
>search.cgi</TT
>.</P
><P
>Например, если shtml страница содержит строку
<TT
CLASS="literal"
>&#60;--#include virtual="search.cgi"&#62;</TT
>,
переменная SCRIPT_NAME будет указывать на <TT
CLASS="filename"
>search.cgi</TT
>, а не на shtml страницу.</P
><P
>Для возможности отказа от использования переменной SCRIPT_NAME, мы ввели переменную DPSEARCH_SELF,
которую вам необходимо добавить в конфигурацию сервера Apache <TT
CLASS="filename"
>httpd.conf</TT
>.А <TT
CLASS="filename"
>search.cgi</TT
>
сначала проверяет переменную DPSEARCH_SELF и только потом, при неудаче SCRIPT_NAME. 
Вот пример использования переменной окружения DPSEARCH_SELF при помощи команд конфигурирования сервера Apache
<B
CLASS="command"
>SetEnv/PassEnv</B
>:
			<PRE
CLASS="programlisting"
>&#13;SetEnv DPSEARCH_SELF /path/to/search.cgi
PassEnv DPSEARCH_SELF
</PRE
>
		</P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search-templates"
>8.1.5. Использование нескольких шаблонов</A
></H2
><P
>Зачастую необходимо использовать несколько различных шаблонов с одним и тем же <TT
CLASS="filename"
>search.cgi</TT
>.
Существует несколько способов сделать это. Они указываются ниже в том порядке, в каком <TT
CLASS="filename"
>search.cgi</TT
>
определяет имя шаблона:
				<P
></P
><OL
TYPE="1"
><LI
><P
>&#13;							<TT
CLASS="filename"
>search.cgi</TT
> проверяет CGI параметр <TT
CLASS="option"
>tmplt</TT
>.
Таким образом вы можете задать имя файла нужного шаблона в этом параметре.</P
></LI
><LI
><P
>&#13;							<TT
CLASS="filename"
>search.cgi</TT
> проверяет переменную окружения
<TT
CLASS="varname"
>DPSEARCH_TEMPLATE</TT
>. Таким образом вы можете установить путь до нужного шаблона в этой переменной.</P
></LI
><LI
><P
><TT
CLASS="filename"
>search.cgi</TT
> проверяет path info часть URL, доступную через переменную окружения PATH_INFO.
Например, <TT
CLASS="filename"
>http://localhost/cgi-bin/search.cgi/search1.html</TT
> в качестве шаблона использует 
<TT
CLASS="filename"
>search1.htm</TT
>,
а <TT
CLASS="filename"
>http://localhost/cgi-bin/search.cgi/search2.html</TT
> использует <TT
CLASS="filename"
>search2.htm</TT
>, и т.д.
</P
></LI
><LI
><P
>&#13;							<TT
CLASS="filename"
>search.cgi</TT
> также поддерживает внуттрений релирект Apache.
Он проверяет переменных окружения <TT
CLASS="varname"
>REDIRECT_STATUS</TT
> и <TT
CLASS="varname"
>REDIRECT_URL</TT
>.
Для использования этого способа указания шаблона, необходимо добавить следующие строчки в файл конфигурации 
Apache <TT
CLASS="filename"
>httpd.conf</TT
>: </P
><P
>&#13;							<PRE
CLASS="programlisting"
>&#13;               AddType text/html .zhtml
               AddHandler zhtml .zhtml
               Action zhtml /cgi-bin/search.cgi
               </PRE
>
						</P
><P
>Поместите
<TT
CLASS="filename"
>search.cgi</TT
> в вашу
<TT
CLASS="filename"
>/cgi-bin/</TT
> директорию. Затем поместите HTML-шаблон на вашем сервере с расширением .zhtml,
например, <TT
CLASS="filename"
>template.zhtml</TT
>. Теперь вы можете открыть страницу поиска:
<TT
CLASS="literal"
>http://www.site.com/path/to/template.zhtml</TT
> 
Конечно, вы можете использовать любое свободное расширение вместо .zhtml. </P
></LI
><LI
><P
>Если два предыдущих способа не помогли определить имя шаблона,
<TT
CLASS="filename"
>search.cgi</TT
> откроет шаблон с тем же именем, что и выполняемая CGI-программа, имя которой указано в
переменной окружения
<TT
CLASS="varname"
>SCRIPT_NAME</TT
>. Т.е. <TT
CLASS="filename"
>search.cgi</TT
> бужет использовать шаблон
<TT
CLASS="filename"
>ETC/search.htm</TT
>, <TT
CLASS="filename"
>search1.cgi</TT
>
будет использовать шаблон <TT
CLASS="filename"
>ETC/search1.htm</TT
> и т.д., где ETC - <TT
CLASS="filename"
>/etc</TT
> директория
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> (обычно это
<TT
CLASS="literal"
>/usr/local/dpsearch/etc</TT
>). Таким образом вы можете использовать без перекомпиляции тот же 
самый <B
CLASS="command"
>search.cgi</B
> с различными шаблонами. Просто создайте несколько линков на <B
CLASS="command"
>search.cgi</B
>
с различными именами, соответствующими нужным шаблонам в директории <TT
CLASS="filename"
>/etc</TT
>
<SPAN
CLASS="application"
>DataparkSearch</SPAN
>. </P
><P
>См. также <A
HREF="dpsearch-multilang.ru.html"
>&#1056;&#1072;&#1079;&#1076;. 7.2</A
> </P
></LI
></OL
>
        </P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search-bool"
>8.1.6. Булев поиск
<A
NAME="AEN4479"
></A
></A
></H2
><P
>Для задания более сложных запросов, вы можете строить булевы запросы поиска.
Необходимо в поисковой форме указать режим поиска <TT
CLASS="option"
>bool</TT
>.
</P
><P
><SPAN
CLASS="application"
>DataparkSearch</SPAN
> понимает следющие булевы операторы:</P
><P
><TT
CLASS="userinput"
><B
>AND</B
></TT
> или <TT
CLASS="userinput"
><B
>&#38;</B
></TT
> - логическое И. 
Например, <TT
CLASS="literal"
>mysql &#38; odbc</TT
>.
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> будет искать URL, содержащие оба слова "mysql" и "odbc".
Вы также можете использовать знак <TT
CLASS="userinput"
><B
>+</B
></TT
> для этого оператора.</P
><P
><TT
CLASS="userinput"
><B
>NEAR</B
></TT
> - Оператор NEAR принимает истиное значение если оба слова 
находятся не далее, чем в 16 словах друг от друга. 
Например, <TT
CLASS="literal"
>mysql NEAR odbc</TT
>.
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> будет искать URL, содержащие оба слова "mysql" и "odbc", 
расположеные на расстоянии не далее 16 слов друг от друга.</P
><P
><TT
CLASS="userinput"
><B
>ANYWORD</B
></TT
> или <TT
CLASS="userinput"
><B
>*</B
></TT
> - Оператор ANYWORD аналогичен оператору И, 
но принимает истиное значение, если между обеими словами находится одно любое слово и левый операнд имеет меньшую позицию, нежели правый. 
Например, "<TT
CLASS="userinput"
><B
>mysql * odbc</B
></TT
>"  - 
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> найдёт все документы, содержащие оба слова "mysql" и
"odbc", и меющие любое слово между ними, например, документы с фразой "mysql via odbc".</P
><P
><TT
CLASS="userinput"
><B
>OR</B
></TT
> или <TT
CLASS="userinput"
><B
>|</B
></TT
> - логическое ИЛИ. 
Например, <TT
CLASS="literal"
>mysql|odbc</TT
>.
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> будет искать URL, содержащие или слово "mysql" или слово "odbc".</P
><P
><TT
CLASS="userinput"
><B
>NOT</B
></TT
> или <TT
CLASS="userinput"
><B
>~</B
></TT
> - логическое НЕ. 
Например, <TT
CLASS="literal"
>mysql &#38; ~ odbc</TT
>.
<SPAN
CLASS="application"
>DataparkSearch</SPAN
> будет искать URL, содержащие слово "mysql" и в тоже время не содержащие слово "odbc".
Обратите внимание, что ~ всего лишь исключает некоторые документы из результата поиска. Запрос "~ odbc" ничего не найдёт!
</P
><P
><TT
CLASS="userinput"
><B
>()</B
></TT
> - оператор группирования для создания более сложных запросов поиска. Например,
<TT
CLASS="literal"
>(mysql | msql) &#38; ~ postgres</TT
>.</P
><P
><TT
CLASS="userinput"
><B
>"</B
></TT
> - оператор выделения фраз. Например, <TT
CLASS="literal"
>"russian apache" &#38; "web server"</TT
>.
Вы также можете использовать знак <TT
CLASS="userinput"
><B
>'</B
></TT
> для этого оператора.</P
><P
>Язык запросов хоть и прост, но достаточно мощный. Рассматривайте такой запрос как обычное
булево выражение.</P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="vql"
>8.1.7. Язык запросов Verity Query Language, VQL</A
></H2
><P
><SPAN
CLASS="application"
>DataparkSearch</SPAN
> поддерживает только префиксный вариант <SPAN
CLASS="application"
>Verity Query Language</SPAN
>.</P
><P
>Также поддерживается только следующее подмножество операторов VQL:</P
><DIV
CLASS="table"
><A
NAME="vql-operators"
></A
><P
><B
>&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 8-2. Операторы VQL, поддерживаемые DataparkSearch</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><TBODY
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;ACCRUE&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен оператору <TT
CLASS="userinput"
><B
>OR</B
></TT
> булевого запроса.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;AND&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен оператору <TT
CLASS="userinput"
><B
>AND</B
></TT
> булевого запроса.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;ANY&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен оператору <TT
CLASS="userinput"
><B
>OR</B
></TT
> булевого запроса.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;NEAR&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен оператору <TT
CLASS="userinput"
><B
>NEAR</B
></TT
> булевого запроса.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;NOT&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен оператору <TT
CLASS="userinput"
><B
>NOT</B
></TT
> булевого запроса.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;OR&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен оператору <TT
CLASS="userinput"
><B
>OR</B
></TT
> булевого запроса.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;PHRASE&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>эквивалентен фразе в булевом запросе.</TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>&#60;WORD&#62;</TD
><TD
ALIGN="LEFT"
VALIGN="MIDDLE"
>рассматривается как пустой оператор.</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="search-exp"
>8.1.8. Как используются при поиске устаревшие документы</A
></H2
><P
>Устаревшие документы продолжают включаться в результаты поиска по их старому содержимому до тех пор,
пока эти документы не будут удалены или обновлены с очередным переиндексированием.</P
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="dpsearch-vary.ru.html"
ACCESSKEY="P"
>&#1055;&#1088;&#1077;&#1076;.</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.ru.html"
ACCESSKEY="H"
>&#1053;&#1072;&#1095;&#1072;&#1083;&#1086;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="dpsearch-mod_dpsearch.ru.html"
ACCESSKEY="N"
>&#1057;&#1083;&#1077;&#1076;.</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Поддержка мультиязычных веб серверов</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Модуль <TT
CLASS="literal"
>mod_dpsearch</TT
> для Apache httpd
<A
NAME="AEN4564"
></A
>
<A
NAME="AEN4566"
></A
>
<A
NAME="AEN4569"
></A
>
<A
NAME="AEN4572"
></A
></TD
></TR
></TABLE
></DIV
><!--#include virtual="body-after.html"--></BODY
></HTML
>